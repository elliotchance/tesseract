data:
  table1:
  - {"foo": 125}
  - {"foo": 124}
  - {"foo": 123}

  table2:
  - {"first": "Elliot", "last": "Chance"}

tests:
  fail_1:
    sql: SELECT
    error: Expected expression after SELECT.

  fail_2:
    sql: SELECT *
    error: Missing FROM clause.

  fail_3:
    sql: SELECT * FROM
    error: Expected table name after FROM.

  simple:
    data: table1
    sql: SELECT * FROM table1
    result:
    - {"foo": 123}
    - {"foo": 124}
    - {"foo": 125}

  where:
    data: table1
    sql: SELECT * FROM table1 WHERE foo = 124
    result:
    - {"foo": 124}

  one_column:
    data: table2
    sql: SELECT first FROM table2
    result:
    - {"first": "Elliot"}

  missing_column_will_not_appear_in_the_output:
    data: table2
    sql: SELECT does_not_exist FROM table2
    result:
    - {}

  colums_are_case_sensitive:
    data: table2
    sql: SELECT First FROM table2
    result:
    - {}

  select_from_table_that_doesnt_exist:
    sql: SELECT * FROM %table_name%
    result: []
