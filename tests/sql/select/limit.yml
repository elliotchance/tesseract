data:
  table1:
  - {"foo": 123}
  - {"foo": 124}
  - {"foo": 125}
  - {"foo": 126}
  - {"foo": 127}

tests:
  parser_limit:
    sql: SELECT * FROM table1 LIMIT 10

  parser_limit_offset:
    sql: SELECT * FROM table1 LIMIT 20 OFFSET 10

  parser_offset:
    sql: SELECT * FROM table1 OFFSET 10

  simple_limit:
    data: table1
    sql: SELECT * FROM table1 ORDER BY foo LIMIT 2
    result:
    - {"foo": 123}
    - {"foo": 124}

  limit_too_large:
    data: table1
    sql: SELECT * FROM table1 ORDER BY foo LIMIT 20
    result:
    - {"foo": 123}
    - {"foo": 124}
    - {"foo": 125}
    - {"foo": 126}
    - {"foo": 127}

  simple_limit_offset:
    data: table1
    sql: SELECT * FROM table1 ORDER BY foo LIMIT 3 OFFSET 2
    result:
    - {"foo": 125}
    - {"foo": 126}
    - {"foo": 127}

  offset_too_big:
    data: table1
    sql: SELECT * FROM table1 ORDER BY foo LIMIT 3 OFFSET 20
    result: []
