data:
  duplicates:
  - {"foo": null, "bar": 1}
  - {"foo": 40, "bar": 2}
  - {"foo": "abc", "bar": 3}
  - {"foo": "50", "bar": 4}
  - {"foo": 100, "bar": 5}
  - {"foo": "zzz", "bar": 6}
  - {"foo": null, "bar": 7}
  - {"foo": 100, "bar": 8}
  - {"foo": "abc", "bar": 9}
  - {"foo": 50, "bar": 10}
  - {"bar": 11}

  non_duplicates:
  - {"foo": null, "bar": 1}
  - {"foo": 40, "bar": 2}
  - {"foo": "abc", "bar": 3}
  - {"foo": "50", "bar": 4}
  - {"foo": 100, "bar": 5}
  - {"foo": "zzz", "bar": 6}
  - {"foo": 50, "bar": 10}

tests:
  order_by_mixed:
    data-randomized: non_duplicates
    repeat: 10
    sql: SELECT * FROM non_duplicates ORDER BY foo
    result:
    - {"foo": 40, "bar": 2}
    - {"foo": 50, "bar": 10}
    - {"foo": 100, "bar": 5}
    - {"foo": "50", "bar": 4}
    - {"foo": "abc", "bar": 3}
    - {"foo": "zzz", "bar": 6}
    - {"foo": null, "bar": 1}

  explicit_asc:
    data: duplicates
    sql: SELECT * FROM duplicates ORDER BY foo ASC
    result:
    - {"foo": 40, "bar": 2}
    - {"foo": 50, "bar": 10}
    - {"foo": 100, "bar": 5}
    - {"foo": 100, "bar": 8}
    - {"foo": "50", "bar": 4}
    - {"foo": "abc", "bar": 3}
    - {"foo": "abc", "bar": 9}
    - {"foo": "zzz", "bar": 6}
    - {"foo": null, "bar": 1}
    - {"foo": null, "bar": 7}
    - {"bar": 11}

  order_by_mixed_descending:
    data-randomized: non_duplicates
    repeat: 10
    sql: SELECT * FROM non_duplicates ORDER BY foo DESC
    result:
    - {"foo": null, "bar": 1}
    - {"foo": "zzz", "bar": 6}
    - {"foo": "abc", "bar": 3}
    - {"foo": "50", "bar": 4}
    - {"foo": 100, "bar": 5}
    - {"foo": 50, "bar": 10}
    - {"foo": 40, "bar": 2}

  order_by_null_only:
    sql: SELECT * FROM duplicates WHERE foo IS null ORDER BY foo
    result:
    - {"foo": null, "bar": 1}
    - {"foo": null, "bar": 7}
    - {"bar": 11}
